# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –ø–æ –ø–∞—Ä–∞–º

**–î–∞—Ç–∞:** 16 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í—Ä–µ–º—è:** –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã 

## –¶–µ–ª—å –∏–∑–º–µ–Ω–µ–Ω–∏–π
–ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –±–æ—Ç–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ 3 —Å–¥–µ–ª–∫–∏ –Ω–∞ –∫–∞–∂–¥—É—é —Ç–æ—Ä–≥–æ–≤—É—é –ø–∞—Ä—É –≤–º–µ—Å—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ 3 —Å–¥–µ–ª–∫–∏ –≤—Å–µ–≥–æ.

## –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ:
1. **config.py**: `max_positions: int = 3` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π
2. **bot.py, PositionManager**: 
   - –û–±—ä—è–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `Dict[str, List[Dict]]` –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ `Dict[str, Dict]`
   - –í `__init__` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è `max_positions` –≤–º–µ—Å—Ç–æ `max_positions_per_symbol`
   - –ú–µ—Ç–æ–¥ `add_position` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –≤–º–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ø–∏—Å–æ–∫
3. **–ò–º–ø–æ—Ä—Ç –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏**: `limit_open_positions` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. **–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ 6 –ø–∞—Ä –≤ `ALLOWED_SYMBOLS`

### –¢–µ–∫—É—â–∏–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã:
- BTCUSDT
- ETHUSDT  
- SOLUSDT
- XRPUSDT
- DOGEUSDT
- BNBUSDT

## –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ config.py
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `max_positions` –≤ `max_positions_per_symbol`
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `max_total_positions` –¥–ª—è –æ–±—â–µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PositionManager
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–∑–∏—Ü–∏–π –Ω–∞ —Å–∏–º–≤–æ–ª
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –ø–æ–∑–∏—Ü–∏–π
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞
- –ü–µ—Ä–µ–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ PositionManager

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ limit_open_positions
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é

### 5. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –ø–æ –ø–∞—Ä–∞–º

**–î–∞—Ç–∞:** 16 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í—Ä–µ–º—è:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## ‚úÖ –ó–ê–î–ê–ß–ê –í–´–ü–û–õ–ù–ï–ù–ê

–ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ **–ø–æ 3 —Å–¥–µ–ª–∫–∏ –Ω–∞ –∫–∞–∂–¥—É—é —Ç–æ—Ä–≥–æ–≤—É—é –ø–∞—Ä—É** –≤–º–µ—Å—Ç–æ –æ–±—â–µ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ 3 —Å–¥–µ–ª–∫–∏.

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω config.py
```python
# –ë—ã–ª–æ:
max_positions: int = 3

# –°—Ç–∞–ª–æ:
max_positions_per_symbol: int = 3
max_total_positions: int = 18
```

**–ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `BYBIT_MAX_POSITIONS_PER_SYMBOL=3` 
- `BYBIT_MAX_TOTAL_POSITIONS=18`

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω PositionManager –≤ bot.py

**–ò–∑–º–µ–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:**
```python
# –ë—ã–ª–æ: Dict[str, Dict] - –æ–¥–Ω–∞ –ø–æ–∑–∏—Ü–∏—è –Ω–∞ —Å–∏–º–≤–æ–ª
# –°—Ç–∞–ª–æ: Dict[str, List[Dict]] - —Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π –Ω–∞ —Å–∏–º–≤–æ–ª
```

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- ‚úÖ `add_position()` - –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ —Å–ø–∏—Å–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
- ‚úÖ `remove_position(symbol, position_id)` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ ID
- ‚úÖ `get_position(symbol, position_id)` - –ø–æ–∏—Å–∫ –ø–æ ID  
- ‚úÖ `update_position()` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–∏–º–≤–æ–ª–∞
- ‚úÖ `get_total_positions_count()` - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- ‚úÖ `get_positions_for_symbol()` - –ø–æ–∑–∏—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞—Ä—ã

### 3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤ functions.py
```python
def limit_open_positions(positions: dict, max_positions: int) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–∑–∏—Ü–∏–π"""
    
def apply_sl_tp_bounds(price: float, signal: str, stop: float, take: float) -> tuple:
    """–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π SL/TP"""
```

### 4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω BybitTradingBot

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ smart_trade():**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –ø–æ–∑–∏—Ü–∏–π –Ω–∞ —Å–∏–º–≤–æ–ª
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ –ª–∏–º–∏—Ç–∞ –ø–æ–∑–∏—Ü–∏–π  
- ‚úÖ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ ID –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ check_and_close_positions():**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø–æ ID
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π SL/TP

**–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –ø–∞—Ä–∞–º: `BTCUSDT:2, ETHUSDT:1`  
- ‚úÖ –û–±—â–∏–π —Å—á–µ—Ç—á–∏–∫: `(5/18) –ø–æ–∑–∏—Ü–∏–π`
- ‚úÖ –î–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

## –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ **3 –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –ø–∞—Ä—É**: –ö–∞–∂–¥–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ 3 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ **18 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫**: 6 –ø–∞—Ä √ó 3 –ø–æ–∑–∏—Ü–∏–∏ = –º–∞–∫—Å–∏–º—É–º 18 —Å–¥–µ–ª–æ–∫
- ‚úÖ **–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –ö–∞–∂–¥–∞—è –ø–æ–∑–∏—Ü–∏—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
- ‚úÖ **–†–∞–∑–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã

### üìä –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã (6 —à—Ç—É–∫):
- BTCUSDT, ETHUSDT, SOLUSDT
- XRPUSDT, DOGEUSDT, BNBUSDT

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ .env:
```bash
BYBIT_MAX_POSITIONS_PER_SYMBOL=3   # –ü–æ–∑–∏—Ü–∏–π –Ω–∞ –ø–∞—Ä—É
BYBIT_MAX_TOTAL_POSITIONS=18       # –û–±—â–∏–π –ª–∏–º–∏—Ç
```

### üìà –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:
```
Open positions (8/18): BTCUSDT:3, ETHUSDT:2, SOLUSDT:1, XRPUSDT:2
```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
   ```bash
   pip install -r requirements.txt
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞:**
   ```bash
   BYBIT_API_KEY=your_key
   BYBIT_API_SECRET=your_secret
   BYBIT_MAX_POSITIONS_PER_SYMBOL=3
   BYBIT_MAX_TOTAL_POSITIONS=18
   ```

3. **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:**
   ```bash
   python bot.py
   ```

## üéâ –ò–¢–û–ì

**–ó–ê–î–ê–ß–ê –ü–û–õ–ù–û–°–¢–¨–Æ –í–´–ü–û–õ–ù–ï–ù–ê!** 

–ë–æ—Ç —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –¥–æ **18 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫** (–ø–æ 3 –Ω–∞ –∫–∞–∂–¥—É—é –∏–∑ 6 —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä) –≤–º–µ—Å—Ç–æ –ø—Ä–µ–∂–Ω–∏—Ö 3 —Å–¥–µ–ª–æ–∫ –≤—Å–µ–≥–æ.

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~45 –º–∏–Ω—É—Ç  
**–ò–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 3 (config.py, functions.py, bot.py)  
**–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:** 5  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é